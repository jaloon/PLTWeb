$(function(){var f=parent.layer.getFrameIndex(window.name);var e="修改成功！";var h="修改失败！";var g=$("#mode").val();$("#cancel").click(function(){parent.layer.close(f)});$("#confirm").click(function(){var r=$("#id").val();var t=$("#type").val();var v;try{v=parseVerToInt($("#ver").val())}catch(u){layer.alert(u,{icon:2},function(i){layer.close(i);$("#ver").select()});return}var c=$.trim($("#model").val());var d=$("#center").val();var a=$.trim($("#produce").val());var q=$.trim($("#delivery").val());var b=$.trim($("#remark").val());var s="../../manage/device/update.do";var p="id="+r+"&type="+t+"&ver="+v+"&model="+c+"&centerId="+d+"&produce="+a+"&delivery="+q+"&remark="+b;if("add"==g){typeName=$("#type").find("option:selected").text();s="../../manage/device/add.do";p="type="+t+"&ver="+v+"&model="+c+"&centerId="+d+"&produce="+a+"&delivery="+q+"&remark="+b;e="添加成功！";h="添加失败！"}$.post(s,p,function(i){if("error"==i.msg){layer.msg(h,{icon:2,time:500})}else{layer.msg(e,{icon:1,time:500},function(){parent.layer.close(f)})}},"json").fail(function(k,i,j){if(k.readyState==4){var l=k.status;if(l==0||l>600){location.reload(true)}else{if(l==200){if(i=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+i)}}else{layer.alert("http connection error: status["+l+"], "+k.statusText)}}}})})});