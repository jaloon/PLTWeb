$(function(){var a=parent.layer.getFrameIndex(window.name);var b="修改成功！";var c="修改失败！";var d=$("#mode").val();$("#cancel").click(function(){parent.layer.close(a)});$("#confirm").click(function(){var h=$("#id").val();var f=$("#type").val();var o;try{o=parseVerToInt($("#ver").val())}catch(e){layer.alert(e,{icon:2},function(p){layer.close(p);$("#ver").select()});return}var l=$.trim($("#model").val());var k=$("#center").val();var n=$.trim($("#produce").val());var i=$.trim($("#delivery").val());var m=$.trim($("#remark").val());var g="../../manage/device/update.do";var j="id="+h+"&type="+f+"&ver="+o+"&model="+l+"&centerId="+k+"&produce="+n+"&delivery="+i+"&remark="+m;if("add"==d){typeName=$("#type").find("option:selected").text();g="../../manage/device/add.do";j="type="+f+"&ver="+o+"&model="+l+"&centerId="+k+"&produce="+n+"&delivery="+i+"&remark="+m;b="添加成功！";c="添加失败！"}$.post(g,j,function(p){if("error"==p.msg){layer.msg(c,{icon:2,time:500})}else{layer.msg(b,{icon:1,time:500},function(){parent.layer.close(a)})}},"json").fail(function(q,s,r){if(q.readyState==4){var p=q.status;if(p==0||p>600){location.reload(true)}else{if(p==200){if(s=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+s)}}else{layer.alert("http connection error: status["+p+"], "+q.statusText)}}}})})});