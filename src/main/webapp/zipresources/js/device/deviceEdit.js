$(function(){var f=parent.layer.getFrameIndex(window.name);var e="修改成功！";var h="修改失败！";var g=$("#mode").val();$("#cancel").click(function(){parent.layer.close(f)});$("#confirm").click(function(){var d=$("#id").val();var q=$("#type").val();var s;try{s=parseVerToInt($("#ver").val())}catch(r){layer.alert(r,{icon:2},function(i){layer.close(i);$("#ver").select()});return}var v=$.trim($("#model").val());var a=$("#center").val();var t=$.trim($("#produce").val());var c=$.trim($("#delivery").val());var u=$.trim($("#remark").val());var p="../../manage/device/update.do";var b="id="+d+"&type="+q+"&ver="+s+"&model="+v+"&centerId="+a+"&produce="+t+"&delivery="+c+"&remark="+u;if("add"==g){typeName=$("#type").find("option:selected").text();p="../../manage/device/add.do";b="type="+q+"&ver="+s+"&model="+v+"&centerId="+a+"&produce="+t+"&delivery="+c+"&remark="+u;e="添加成功！";h="添加失败！"}$.post(p,b,function(i){if("error"==i.msg){layer.msg(h,{icon:2,time:500})}else{layer.msg(e,{icon:1,time:500},function(){parent.layer.close(f)})}},"json").fail(function(k,i,j){if(k.readyState==4){var l=k.status;if(l==0||l>600){location.reload(true)}else{if(l==200){if(i=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+i)}}else{layer.alert("http connection error: status["+l+"], "+k.statusText)}}}})})});