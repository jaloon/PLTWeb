$(function(){var f=parent.layer.getFrameIndex(window.name);var e;var a="修改成功！";var b="修改失败！";var d=$("#mode").val();$("#centers").click(function(){var h="389px";if("view"==d){var g=$("#centers").html();if(g.length==0){return}h="325px"}e=layer.open({type:1,title:["所属用户中心 ","font-size:14px;color:#ffffff;background:#478de4;"],area:["500px",h],content:$(".centers"),end:c()})});$("#center_cancel").click(function(){layer.close(e)});$("#center_confirm").click(function(){$(".center").removeClass("checked");var h=$(".center:checked");h.addClass("checked");var g="";h.each(function(){g+="、"+$(this).next().html()});if(g.length>0){g=g.slice(1)}$("#centers").html(g);layer.close(e)});function c(){$(".center").prop("checked",false);$(".checked").prop("checked",true)}$("#cancel").click(function(){parent.layer.close(f)});$("#confirm").click(function(){var g=$("#id").val();var p=$("#uuid").val();var j=$("#system").val();var m=$("#model").val();var r=$("#current").val();var o=$("#owner").val();var k=$("#phone").val();var i=$("#duty").val();var l=$("#org").val();var q="";$(".checked").each(function(){q+=","+$(this).val()});if(q.length>0){q=q.slice(1)}var n="../../manage/appdev/update.do";var s="id="+g+"&uuid="+p+"&system="+j+"&model="+m+"&currentVer="+r+"&owner="+o+"&phone="+k+"&duty="+i+"&institution="+l+"&centerIds="+q;if("add"==d){n="../../manage/appdev/add.do";s="uuid="+p+"&system="+j+"&model="+m+"&currentVer="+r+"&owner="+o+"&phone="+k+"&duty="+i+"&institution="+l+"&centerIds="+q;a="添加成功！";b="添加失败！";if(isNull(p)){layer.alert("手机UUID不能为空！",{icon:0},function(t){layer.close(t);$("#uuid").select()});return}else{var h=true;$.ajax({type:"post",async:false,url:"../../manage/appdev/isExist.do",data:"uuid="+p,dataType:"json",success:function(t){if(t==true||t=="true"){h=false;layer.alert("手机UUID已存在！",{icon:5},function(u){layer.close(u);$("#uuid").select()})}},error:function(t,v,u){h=false;if(t.readyState==4){var w=t.status;if(w==0||w>600){location.reload(true)}else{if(w==200){if(v=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+v)}}else{layer.alert("http connection error: status["+w+"], "+t.statusText)}}}}});if(!h){return}}}if(!isVer(r)){layer.alert("当前版本不符合版本号格式！",{icon:2},function(t){layer.close(t);$("#current").select()});return}$.post(n,s,function(t){if("error"==t.msg){layer.msg(b,{icon:2,time:500})}else{layer.msg(a,{icon:1,time:500},function(){parent.layer.close(f)})}},"json").fail(function(t,v,u){if(t.readyState==4){var w=t.status;if(w==0||w>600){location.reload(true)}else{if(w==200){if(v=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+v)}}else{layer.alert("http connection error: status["+w+"], "+t.statusText)}}}})})});