$(function(){var d=parent.layer.getFrameIndex(window.name);var c;var e="修改成功！";var f="修改失败！";var b=$("#mode").val();$("#centers").click(function(){var h="389px";if("view"==b){var g=$("#centers").html();if(g.length==0){return}h="325px"}c=layer.open({type:1,title:["所属用户中心 ","font-size:14px;color:#ffffff;background:#478de4;"],area:["500px",h],content:$(".centers"),end:a()})});$("#center_cancel").click(function(){layer.close(c)});$("#center_confirm").click(function(){$(".center").removeClass("checked");var h=$(".center:checked");h.addClass("checked");var g="";h.each(function(){g+="、"+$(this).next().html()});if(g.length>0){g=g.slice(1)}$("#centers").html(g);layer.close(c)});function a(){$(".center").prop("checked",false);$(".checked").prop("checked",true)}$("#cancel").click(function(){parent.layer.close(d)});$("#confirm").click(function(){var m=$("#id").val();var s=$("#uuid").val();var k=$("#system").val();var p=$("#model").val();var r=$("#current").val();var o=$("#owner").val();var g=$("#phone").val();var i=$("#duty").val();var q=$("#org").val();var j="";$(".checked").each(function(){j+=","+$(this).val()});if(j.length>0){j=j.slice(1)}var h="../../manage/appdev/update.do";var l="id="+m+"&uuid="+s+"&system="+k+"&model="+p+"&currentVer="+r+"&owner="+o+"&phone="+g+"&duty="+i+"&institution="+q+"&centerIds="+j;if("add"==b){h="../../manage/appdev/add.do";l="uuid="+s+"&system="+k+"&model="+p+"&currentVer="+r+"&owner="+o+"&phone="+g+"&duty="+i+"&institution="+q+"&centerIds="+j;e="添加成功！";f="添加失败！";if(isNull(s)){layer.alert("手机UUID不能为空！",{icon:0},function(t){layer.close(t);$("#uuid").select()});return}else{var n=true;$.ajax({type:"post",async:false,url:"../../manage/appdev/isExist.do",data:"uuid="+s,dataType:"json",success:function(t){if(t==true||t=="true"){n=false;layer.alert("手机UUID已存在！",{icon:5},function(u){layer.close(u);$("#uuid").select()})}},error:function(w,u,t){n=false;if(w.readyState==4){var v=w.status;if(v==0||v>600){location.reload(true)}else{if(v==200){if(u=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+u)}}else{layer.alert("http connection error: status["+v+"], "+w.statusText)}}}}});if(!n){return}}}if(!isVer(r)){layer.alert("当前版本不符合版本号格式！",{icon:2},function(t){layer.close(t);$("#current").select()});return}$.post(h,l,function(t){if("error"==t.msg){layer.msg(f,{icon:2,time:500})}else{layer.msg(e,{icon:1,time:500},function(){parent.layer.close(d)})}},"json").fail(function(w,u,t){if(w.readyState==4){var v=w.status;if(v==0||v>600){location.reload(true)}else{if(v==200){if(u=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+u)}}else{layer.alert("http connection error: status["+v+"], "+w.statusText)}}}})})});