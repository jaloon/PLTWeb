$(function(){var b=parent.layer.getFrameIndex(window.name);var a;var c="修改成功！";var d="修改失败！";var f=$("#mode").val();$("#centers").click(function(){var i="389px";if("view"==f){var g=$("#centers").html();if(g.length==0){return}i="325px"}a=layer.open({type:1,title:["所属用户中心 ","font-size:14px;color:#ffffff;background:#478de4;"],area:["500px",i],content:$(".centers"),end:e()})});$("#center_cancel").click(function(){layer.close(a)});$("#center_confirm").click(function(){$(".center").removeClass("checked");var h=$(".center:checked");h.addClass("checked");var g="";h.each(function(){g+="、"+$(this).next().html()});if(g.length>0){g=g.slice(1)}$("#centers").html(g);layer.close(a)});function e(){$(".center").prop("checked",false);$(".checked").prop("checked",true)}$("#cancel").click(function(){parent.layer.close(b)});$("#confirm").click(function(){var j=$("#id").val();var i=$("#system").val();var o=$("#model").val();var p=$("#current").val();var k=$("#owner").val();var q=$("#phone").val();var r=$("#duty").val();var t=$("#org").val();var l="";$(".checked").each(function(){l+=","+$(this).val()});if(l.length>0){l=l.slice(1)}var h="../../manage/appdev/update.do";var m="id="+j+"&system="+i+"&model="+o+"&currentVer="+p+"&owner="+k+"&phone="+q+"&duty="+r+"&institution="+t+"&centerIds="+l;if("add"==f){var g=$("#uuid").val();var s=$("#appid").val();h="../../manage/appdev/add.do";m="uuid="+g+"&appid="+s+"&system="+i+"&model="+o+"&currentVer="+p+"&owner="+k+"&phone="+q+"&duty="+r+"&institution="+t+"&centerIds="+l;c="添加成功！";d="添加失败！";if(isNull(g)){layer.alert("手机UUID不能为空！",{icon:0},function(u){layer.close(u);$("#uuid").select()});return}if(isNull(s)){layer.alert("应用标识不能为空！",{icon:0},function(u){layer.close(u);$("#appid").select()});return}var n=true;$.ajax({type:"post",async:false,url:"../../manage/appdev/isExist.do",data:"uuid="+g+"&appid="+s,dataType:"json",success:function(u){if(u==true||u=="true"){n=false;layer.alert("手机UUID已存在！",{icon:5},function(v){layer.close(v);$("#uuid").select()})}},error:function(v,x,w){n=false;if(v.readyState==4){var u=v.status;if(u==0||u>600){location.reload(true)}else{if(u==200){if(x=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+x)}}else{layer.alert("http connection error: status["+u+"], "+v.statusText)}}}}});if(!n){return}}if(!isVer(p)){layer.alert("当前版本不符合版本号格式！",{icon:2},function(u){layer.close(u);$("#current").select()});return}$.post(h,m,function(u){if("error"==u.msg){layer.msg(d,{icon:2,time:500})}else{layer.msg(c,{icon:1,time:500},function(){parent.layer.close(b)})}},"json").fail(function(v,x,w){if(v.readyState==4){var u=v.status;if(u==0||u>600){location.reload(true)}else{if(u==200){if(x=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+x)}}else{layer.alert("http connection error: status["+u+"], "+v.statusText)}}}})})});