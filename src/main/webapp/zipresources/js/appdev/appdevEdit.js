$(function(){var c=parent.layer.getFrameIndex(window.name);var d="修改成功！";var a="修改失败！";var b=$("#mode").val();$("#cancel").click(function(){parent.layer.close(c)});$("#confirm").click(function(){var m=$("#id").val();var l=$("#system").val();var q=$("#model").val();var e=$("#current").val();var n=$("#owner").val();var f=$("#phone").val();var h=$("#duty").val();var k=$("#org").val();var j="../../manage/appdev/update.do";var o="id="+m+"&system="+l+"&model="+q+"&currentVer="+e+"&owner="+n+"&phone="+f+"&duty="+h+"&institution="+k;if("add"==b){var g=$("#uuid").val();var i=$("#appid").val();j="../../manage/appdev/add.do";o="uuid="+g+"&appid="+i+"&system="+l+"&model="+q+"&currentVer="+e+"&owner="+n+"&phone="+f+"&duty="+h+"&institution="+k;d="添加成功！";a="添加失败！";if(isNull(g)){layer.alert("手机UUID不能为空！",{icon:0},function(r){layer.close(r);$("#uuid").select()});return}if(isNull(i)){layer.alert("应用标识不能为空！",{icon:0},function(r){layer.close(r);$("#appid").select()});return}var p=true;$.ajax({type:"post",async:false,url:"../../manage/appdev/isExist.do",data:"uuid="+g+"&appid="+i,dataType:"json",success:function(r){if(r==true||r=="true"){p=false;layer.alert("手机UUID已存在！",{icon:5},function(s){layer.close(s);$("#uuid").select()})}},error:function(s,u,t){p=false;if(s.readyState==4){var r=s.status;if(r==0||r>600){location.reload(true)}else{if(r==200){if(u=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+u)}}else{layer.alert("http connection error: status["+r+"], "+s.statusText)}}}}});if(!p){return}}if(!isVer(e)){layer.alert("当前版本不符合版本号格式！",{icon:2},function(r){layer.close(r);$("#current").select()});return}$.post(j,o,function(r){if("error"==r.msg){layer.msg(a,{icon:2,time:500})}else{layer.msg(d,{icon:1,time:500},function(){parent.layer.close(c)})}},"json").fail(function(s,u,t){if(s.readyState==4){var r=s.status;if(r==0||r>600){location.reload(true)}else{if(r==200){if(u=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+u)}}else{layer.alert("http connection error: status["+r+"], "+s.statusText)}}}})})});