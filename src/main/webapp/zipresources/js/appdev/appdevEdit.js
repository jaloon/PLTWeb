$(function(){var b=parent.layer.getFrameIndex(window.name);var a;var c="修改成功！";var d="修改失败！";var f=$("#mode").val();$("#centers").click(function(){var h="389px";if("view"==f){var g=$("#centers").html();if(g.length==0){return}h="325px"}a=layer.open({type:1,title:["所属用户中心 ","font-size:14px;color:#ffffff;background:#478de4;"],area:["500px",h],content:$(".centers"),end:e()})});$("#center_cancel").click(function(){layer.close(a)});$("#center_confirm").click(function(){$(".center").removeClass("checked");var h=$(".center:checked");h.addClass("checked");var g="";h.each(function(){g+="、"+$(this).next().html()});if(g.length>0){g=g.slice(1)}$("#centers").html(g);layer.close(a)});function e(){$(".center").prop("checked",false);$(".checked").prop("checked",true)}$("#cancel").click(function(){parent.layer.close(b)});$("#confirm").click(function(){var g=$("#id").val();var r=$("#uuid").val();var m=$("#system").val();var l=$("#model").val();var i=$("#current").val();var p=$("#owner").val();var o=$("#phone").val();var k=$("#duty").val();var j=$("#org").val();var s="";$(".checked").each(function(){s+=","+$(this).val()});if(s.length>0){s=s.slice(1)}var n="../../manage/appdev/update.do";var q="id="+g+"&uuid="+r+"&system="+m+"&model="+l+"&currentVer="+i+"&owner="+p+"&phone="+o+"&duty="+k+"&institution="+j+"&centerIds="+s;if("add"==f){n="../../manage/appdev/add.do";q="uuid="+r+"&system="+m+"&model="+l+"&currentVer="+i+"&owner="+p+"&phone="+o+"&duty="+k+"&institution="+j+"&centerIds="+s;c="添加成功！";d="添加失败！";if(isNull(r)){layer.alert("手机UUID不能为空！",{icon:0},function(t){layer.close(t);$("#uuid").select()});return}else{var h=true;$.ajax({type:"post",async:false,url:"../../manage/appdev/isExist.do",data:"uuid="+r,dataType:"json",success:function(t){if(t==true||t=="true"){h=false;layer.alert("手机UUID已存在！",{icon:5},function(u){layer.close(u);$("#uuid").select()})}},error:function(v,t,w){h=false;if(v.readyState==4){var u=v.status;if(u==0||u>600){location.reload(true)}else{if(u==200){if(t=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+t)}}else{layer.alert("http connection error: status["+u+"], "+v.statusText)}}}}});if(!h){return}}}if(!isVer(i)){layer.alert("当前版本不符合版本号格式！",{icon:2},function(t){layer.close(t);$("#current").select()});return}$.post(n,q,function(t){if("error"==t.msg){layer.msg(d,{icon:2,time:500})}else{layer.msg(c,{icon:1,time:500},function(){parent.layer.close(b)})}},"json").fail(function(v,t,w){if(v.readyState==4){var u=v.status;if(u==0||u>600){location.reload(true)}else{if(u==200){if(t=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+t)}}else{layer.alert("http connection error: status["+u+"], "+v.statusText)}}}})})});