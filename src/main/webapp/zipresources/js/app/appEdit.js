$(function(){var h=parent.layer.getFrameIndex(window.name);var g="修改成功！";var f="修改失败！";var e=$("#mode").val();$("#cancel").click(function(){parent.layer.close(h)});$("#confirm").click(function(){var s=$("#id").val();var a=$("#uuid").val();var t=$("#system").val();var d=$("#model").val();var v=$("#center").val();var c=$("#current").val();var b=$("#assign").val();var r=$("#minver").val();var u="../../manage/app/update.do";var q="id="+s+"&uuid="+a+"&system="+t+"&model="+d+"&center.id="+v+"&currentVer="+c+"&assignVer="+b+"&minVer="+r;if("add"==e){u="../../manage/app/add.do";q="uuid="+a+"&system="+t+"&model="+d+"&center.id="+v+"&currentVer="+c+"&assignVer="+b+"&minVer="+r;g="添加成功！";f="添加失败！";if(isNull(a)){layer.alert("手机UUID不能为空！",{icon:0},function(i){layer.close(i);$("#uuid").select()});return}else{var p=true;$.ajax({type:"post",async:false,url:"../../manage/app/isExist.do",data:"uuid="+a,dataType:"json",success:function(i){if(i==true||i=="true"){p=false;layer.alert("手机UUID已存在！",{icon:5},function(j){layer.close(j);$("#uuid").select()})}},error:function(k,i,j){if(k.readyState==4){var l=k.status;if(l==0||l>600){location.reload(true)}else{if(l==200){if(i=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+i)}}else{layer.alert("http connection error: status["+l+"], "+k.statusText)}}}}});if(!p){return}}}if(!isVer(c)){layer.alert("当前版本不符合版本号格式！",{icon:2},function(i){layer.close(i);$("#current").select()});return}if(!isVer(b)){layer.alert("指定版本不符合版本号格式！",{icon:2},function(i){layer.close(i);$("#assign").select()});return}if(!isVer(r)){layer.alert("最低版本不符合版本号格式！",{icon:2},function(i){layer.close(i);$("#minver").select()});return}$.post(u,q,function(i){if("error"==i.msg){layer.msg(f,{icon:2,time:500})}else{layer.msg(g,{icon:1,time:500},function(){parent.layer.close(h)})}},"json").fail(function(k,i,j){if(k.readyState==4){var l=k.status;if(l==0||l>600){location.reload(true)}else{if(l==200){if(i=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+i)}}else{layer.alert("http connection error: status["+l+"], "+k.statusText)}}}})})});