$(function(){var h=parent.layer.getFrameIndex(window.name);var g="修改成功！";var f="修改失败！";var e=$("#mode").val();$("#cancel").click(function(){parent.layer.close(h)});$("#confirm").click(function(){var n=$("#id").val();var a=$("#assign").val();var c=$("#minver").val();var b="../../manage/appver/update.do";var o="id="+n+"&assignVer="+a+"&minVer="+c;if("add"==e){var m=$("#center").val();var d=$("#system").val();b="../../manage/appver/add.do";o="centerId="+m+"&system="+d+"&assignVer="+a+"&minVer="+c;g="添加成功！";f="添加失败！";var p=true;$.ajax({type:"post",async:false,url:"../../manage/appver/isExist.do",data:"centerId="+m+"&system="+d,dataType:"json",success:function(i){if(i==true||i=="true"){p=false;layer.alert("用户中心"+d+"APP版本配置信息已存在！",{icon:5},function(j){layer.close(j);$("#center").select()})}},error:function(k,i,j){if(k.readyState==4){var l=k.status;if(l==0||l>600){location.reload(true)}else{if(l==200){if(i=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+i)}}else{layer.alert("http connection error: status["+l+"], "+k.statusText)}}}}});if(!p){return}}if(!isVer(a)){layer.alert("指定版本不符合版本号格式！",{icon:2},function(i){layer.close(i);$("#assign").select()});return}if(!isVer(c)){layer.alert("最低版本不符合版本号格式！",{icon:2},function(i){layer.close(i);$("#minver").select()});return}$.post(b,o,function(i){if("error"==i.msg){layer.msg(f,{icon:2,time:500})}else{layer.msg(g,{icon:1,time:500},function(){parent.layer.close(h)})}},"json").fail(function(k,i,j){if(k.readyState==4){var l=k.status;if(l==0||l>600){location.reload(true)}else{if(l==200){if(i=="parsererror"){layer.alert("应答数据格式解析错误！")}else{layer.alert("http response error: "+i)}}else{layer.alert("http connection error: status["+l+"], "+k.statusText)}}}})})});